echo               both
dimension          3
units              si
atom_style        meso
boundary          f f f

# create simulation box
#3D box
variable           L  equal 0.1e-4
region             box block 0.0 ${L}  0.0 ${L} 0.0 ${L} units box
create_box         1 box

# create fluid particles

#lattice            fcc 0.025e-3
lattice            sc 0.025e-3
create_atoms       1 region box

#special_bonds   lj 1 1 1
#bond_style fene
#bond_coeff * 1 5e-5 0 0


mass               1 3.90625e-12
set                group all meso_rho 1000.0

# smothing length
variable          h equal 6.5e-5


# use Tait's EOS in combination with Morris' laminar viscosity.
# We set rho_0 = 1000 kg/m^3, c = 0.1 m/s, h = 6.5e-5 m.
# The dynamic viscosity is set to 1.0e-3 Pa s, corresponding to a kinematic viscosity of 1.0e-6 m^2/s

variable           sdpd_temp index 1e-9
pair_style         sdpd
pair_coeff         * *  1000 1e-4 1.0e-4 6.5e-5 ${sdpd_temp}

compute            rho_peratom all meso_rho/atom
compute            sdpd_kin all temp

# do full time integration for shear driver and fluid, but keep walls stationary
fix                integrate_fix_full all meso

thermo_style       custom step c_sdpd_kin
thermo_modify      norm no
thermo             1

neighbor           3.0e-6 bin
timestep           0
run                1

echo               both
dimension          ${ndim}
units              si
atom_style         hybrid  bond meso
communicate        single vel yes
# create simulation box
shell             mkdir ${dname}
log               ${dname}/log.lammps

#3D box
include            ${ndim}-vars.lmp
read_data           poly3d.txt
#read_restart         sdpd.restart.80000
special_bonds   lj 1 1 1
bond_style fene

mass               * ${sdpd_mass}
set                group all meso_rho ${sdpd_rho}

pair_style         hybrid/overlay sph/rhosum 1 sdpd
pair_coeff         * * sph/rhosum   ${h}
pair_coeff         * *    sdpd ${sdpd_rho0} ${sdpd_c} ${sdpd_eta} ${h} ${sdpd_temp} ${sdpd_background}

compute            rho_peratom all meso_rho/atom
fix                integrate_fix_full all meso

dump               dump_id all custom ${Nfreq} ${dname}/dump*.dat id type x y z vx vy vz c_rho_peratom
dump_modify        dump_id first yes
dump_modify        dump_id sort id
dump_modify        dump_id pad 8

dump dump_id_dcd all dcd ${Nfreq} ${dname}/dump.dcd
dump_modify        dump_id_dcd first yes sort id pad 8

dump dump_id_w all dcd ${Nfreq} ${dname}/wdump.dcd
dump_modify        dump_id_w first yes sort id pad 8 unwrap yes

thermo             100

neighbor           0 bin
neigh_modify       every 1
include            settimestep.lmp
timestep           ${dt}

restart 10000 ${dname}/sdpd.restart

bond_coeff 1 ${H} ${r0}  0 0

run   1000000


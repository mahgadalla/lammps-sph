# move two atoms with FENE bond
echo     both

variable    pmass index 1.0
units       si
atom_style  hybrid  bond meso
atom_modify map array sort 0.0 0.0
# initial data
read_data       polymer.data

set  group all meso_rho 0
set  group all meso_rho 0

bond_style fene/expand
special_bonds 	lj 1 1 1
variable        H_fene equal 0.5
variable        r0_fene equal 1.0
variable        delta equal 0.5
bond_coeff	1 ${H_fene} ${r0_fene} 0.0 0.0 ${delta}

#fix                integrate_fix_full all meso
fix	     1 all nve
neighbor	5.0 bin
neigh_modify    delay 0 every 1


variable pfx equal 10
variable nfx equal -10
group head id == 1
group tail id == 2
fix fhead head addforce  v_nfx 0.0 0.0
fix ftail tail addforce  v_pfx 0.0 0.0

variable        dt equal 1e-2
timestep        ${dt}
variable dxpos equal x[2]-x[1]
variable df equal fx[2]-fx[1]
variable  vtime equal dt*step
fix extra all print 1 "${vtime} ${dxpos} ${df}" file pos.dat.${dt} screen no

variable       time equal 2.0
variable       nstep equal round(${time}/${dt})
thermo         100
run ${nstep}

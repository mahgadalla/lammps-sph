LAMMPS (9 Nov 2011)
echo               both
dimension          3
units              si
atom_style   hybrid  bond meso
boundary          p p p
# create simulation box
#3D box
variable           L  equal 4e-4
region             box block 0.0 ${L}  0.0 ${L} 0.0 ${L} units box
region             box block 0.0 0.0004  0.0 ${L} 0.0 ${L} units box
region             box block 0.0 0.0004  0.0 0.0004 0.0 ${L} units box
region             box block 0.0 0.0004  0.0 0.0004 0.0 0.0004 units box
read_data           poly3d.txt
  1 = max bonds/atom
  orthogonal box = (0 0 0) to (0.0004 0.0004 0.0004)
  1 by 1 by 2 processor grid
  4096 atoms
  4096 velocities
  1216 bonds
  2 = max # of 1-2 neighbors
  2 = max # of 1-3 neighbors
  4 = max # of 1-4 neighbors
  6 = max # of special neighbors

special_bonds   lj 1 1 1
  2 = max # of 1-2 neighbors
  2 = max # of 1-3 neighbors
  4 = max # of 1-4 neighbors
  6 = max # of special neighbors
bond_style fene
bond_coeff 1 3e-5 5e-5  0 0


mass               1 3.90625e-12
set                group all meso_rho 1000.0
  4096 settings made for meso_rho

# smothing length
variable          h equal 6.5e-5

# use Tait's EOS in combination with Morris' laminar viscosity.
# We set rho_0 = 1000 kg/m^3, c = 0.1 m/s, h = 6.5e-5 m.
# The dynamic viscosity is set to 1.0e-3 Pa s, corresponding to a kinematic viscosity of 1.0e-6 m^2/s

variable           sdpd_temp index 1e9
pair_style         hybrid  sdpd
pair_coeff         * *    sdpd 1000 1e-3 1.0e-3 ${h} ${sdpd_temp}
pair_coeff         * *    sdpd 1000 1e-3 1.0e-3 6.5e-05 ${sdpd_temp}
pair_coeff         * *    sdpd 1000 1e-3 1.0e-3 6.5e-05 1e9

compute            rho_peratom all meso_rho/atom
compute            e_peratom all meso_e/atom
compute            ke_peratom all ke/atom
compute            esph all reduce sum c_e_peratom
compute            ke all ke
compute            sdpd_kin all temp
variable           etot equal c_ke+c_esph

#compute            sdpd_kin all temp
#compute            rho_peratom all meso_rho/atom

# do full time integration for shear driver and fluid, but keep walls stationary
fix                integrate_fix_full all meso

dump               dump_id all custom 100 dump*.dat id type x y z vx vy vz c_rho_peratom

dump_modify        dump_id first yes
dump_modify        dump_id sort id
dump_modify        dump_id pad 8
thermo_style       custom step c_sdpd_kin
thermo_modify      norm no
thermo             1
dump imgDump all image 100 image.*.jpg type type atom no bond atom 5e-6 adiam 1e-5 view 60 30 zoom 1.3  box yes 0.01
dump_modify        imgDump pad 9


neighbor           3.0e-6 bin
timestep           1e-7
run                40000
WARNING: Use special bonds = 0,1,1 with bond style fene (bond_fene.cpp:189)
Memory usage per processor = 3.96576 Mbytes
Step sdpd_kin 
       0            0 
       1    60386.919 
       2    182047.21 
       3    303315.15 
       4     424321.6 
       5    548017.46 
       6    663637.35 
       7    778618.19 
       8    903744.75 
       9    1026620.4 
      10    1141453.8 
      11    1263387.2 
      12    1388634.9 
      13    1511216.8 
      14    1638061.2 
      15    1765763.9 
      16    1887070.7 
      17    2003902.9 
      18    2124550.7 
      19      2254492 
      20    2384178.1 
      21    2510969.2 
      22    2638079.8 
      23    2760208.3 
      24    2881495.7 
      25    3000183.2 
      26    3133032.5 
      27      3276972 
      28    3403465.4 
      29    3527244.5 
      30      3650965 
      31      3769687 
      32    3874095.5 
      33    3990127.3 
      34    4112208.3 
      35    4242463.2 
      36      4381914 
      37    4512631.1 
      38      4640878 
      39    4765947.6 
      40    4901424.8 
      41    5035157.2 
      42    5167868.6 
      43    5293443.3 
      44    5413519.3 
      45    5538457.5 
      46    5672128.2 
      47    5820468.8 
      48      5962608 
      49    6091358.5 
      50    6220411.1 
      51    6344441.9 
      52    6459744.1 
      53    6587417.5 
      54    6704620.3 
      55    6806693.8 
      56  
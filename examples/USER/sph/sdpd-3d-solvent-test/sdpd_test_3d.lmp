echo               both
variable           ndim equal 3
dimension          ${ndim}
units              si
atom_style         meso
boundary          p p p
# create simulation box
#3D box
variable           dx   equal 2.5e-5
variable           L  equal 20*${dx}
region             box block 0.0 ${L}  0.0 ${L} 0.0 ${L} units box
create_box         1 box

# create fluid particles
variable           dx equal 2.5e-5
lattice            sc ${dx}
create_atoms       1 region box

variable           sdpd_rho  equal 1e3
variable           m equal  ${sdpd_rho}*${dx}^${ndim}
#mass               1 ${m}
variable           sdpd_rho equal 1000
lattice            sc ${dx}
create_atoms       1 region box

variable           sdpd_mass equal ${dx}*${dx}*${dx}*${sdpd_rho}
#mass               1 ${sdpd_mass}
set                group all meso_rho ${sdpd_rho}

# smothing length
variable          h equal 2.6*${dx}


# use Tait's EOS in combination with Morris' laminar viscosity.
# We set rho_0 = 1000 kg/m^3, c = 0.1 m/s, h = 6.5e-5 m.
# The dynamic viscosity is set to 1.0e-3 Pa s, corresponding to a kinematic viscosity of 1.0e-6 m^2/s
pair_style         hybrid/overlay sph/rhosum 1 sdpd
variable           sdpd_temp index 1e9
pair_coeff         * * sph/rhosum   ${h}
pair_coeff         * *    sdpd ${sdpd_rho} 1e-1 1.56e-2 ${h}  ${sdpd_temp}

compute            sdpd_kin all temp
compute            rho_peratom all meso_rho/atom

# do full time integration for shear driver and fluid, but keep walls stationary
fix                integrate_fix_full all meso

dump               dump_id all custom 10 dump*.dat x y z vx vy vy
dump_modify        dump_id first yes
dump_modify        dump_id sort id
dump_modify        dump_id pad 8
thermo_style       custom step c_sdpd_kin
thermo_modify      norm no
thermo             10
variable           dt index 5e-6
#variable           vkin equal c_sdpd_kin
#fix extra all print 10 "${vkin}" file "kin.dat.dt"

neighbor           3.0e-6 bin
timestep           ${dt}
communicate        single vel yes
run                40000

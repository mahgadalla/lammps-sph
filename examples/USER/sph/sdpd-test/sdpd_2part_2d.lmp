echo               both
dimension          2
units              si
atom_style         meso
boundary          p p p
# create simulation box
#2D box
# domain size
variable          Lx equal 1.000e-3
# the center of the domain
variable          xcenter equal 0.5*${Lx}
# smothing length
variable          h equal 6.5e-5
region             box block 0.0000e-3 ${Lx} 0.0000e-3 ${Lx} -1.0e-6 1.0e-6 units box
create_box         1 box

# create fluid particles
lattice            sq 0.025e-3

# create particles
create_atoms       1 region box

mass               1 1.7e-7
set                group all meso_rho 1000.0

# use Tait's EOS in combination with Morris' laminar viscosity.
# We set rho_0 = 1000 kg/m^3, c = 0.1 m/s, h = 6.5e-5 m.
# The dynamic viscosity is set to 1.0e-3 Pa s, corresponding to a kinematic viscosity of 1.0e-6 m^2/s
#The temperature is set to 1e5C.
pair_style         hybrid sdpd
pair_coeff         * *    sdpd 1000 0.1 2.0e-3 ${h} 1.0

compute            rho_peratom all meso_rho/atom
compute            e_peratom all meso_e/atom
compute            ke_peratom all ke/atom
compute            esph all reduce sum c_e_peratom
compute            ke all ke
compute            sdpd_kin all temp
variable           etot equal c_ke+c_esph

# do full time integration for shear driver and fluid, but keep walls stationary
fix                integrate_fix_full all  meso
dump               dump_id all custom 100 dump*.dat id type x y vx vy c_rho_peratom c_e_peratom
dump_modify        dump_id first yes
dump_modify        dump_id sort id
dump_modify        dump_id pad 8
thermo             10
thermo_style       custom step c_esph v_etot c_sdpd_kin
thermo_modify      norm no

neighbor           3.0e-6 bin
timestep           5.0e-5

run                40000

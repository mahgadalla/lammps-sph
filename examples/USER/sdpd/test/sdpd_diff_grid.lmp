echo               both
dimension          3
units              si
atom_modify map array sort 0 0
atom_style         meso
boundary          p p p
communicate        single vel yes
# create simulation box
#2D box
# domain size

# smothing length
variable          h equal 1.0
variable          dx equal ${h}/3.0
variable          Lx equal 10*${dx}

variable           rho0 equal 1.0
lattice            sc ${dx} origin 0.5 0.5 0.5
region             box block 0 ${Lx} 0 ${Lx} 0 ${Lx} units box
create_box         1 box
create_atoms       1 region box
variable           sdpd_mass  equal ${rho0}*${dx}^3
mass               1 ${sdpd_mass}

pair_style         hybrid/overlay sdpd/rhosum 1 sdpd
variable              c equal 0.1
variable           eta  equal 1.0
variable           temp equal 0.0
variable           gamma equal 1.0
variable           rho_background equal 0.0
pair_coeff         * * sdpd     ${rho0} ${c} ${eta} ${h} ${temp} ${gamma} ${rho_background}
pair_coeff         * * sdpd/rhosum   ${h}

# do full time integration
fix                integrate_fix_full all  meso

neighbor           0 bin
neigh_modify       every 1
timestep           1e-19

variable           force_sdpd_fx equal fx[1]
variable           force_sdpd_fy equal fy[1]
compute            rho_peratom all meso_rho/atom

variable           pi            equal 3.1415927
#variable           vv            atom   
variable           vv            atom   sin(2*${pi}*x/${Lx})


compute            diff_peratom all meso_diff/atom ${h} v_vv
dump               dump_id all custom 1 dump*.dat id type x y z vx vy vz c_rho_peratom c_diff_peratom
variable           dvv           equal c_diff_peratom[1]

run                0

print              "f: ${force_sdpd_fx} ${force_sdpd_fy}"
print              "dA: ${dvv}"


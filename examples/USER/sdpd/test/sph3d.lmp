echo               both
dimension          3
units              si
atom_modify map array sort 0 0
atom_style         meso
boundary          p p p
communicate        single vel yes
# create simulation box
#2D box
# domain size
variable          Lx equal 1.000e-3
# the center of the domain
variable          xcenter equal 0.5*${Lx}
# smothing length
variable          h equal 6.5e-5

region             box block 0 ${Lx} 0 ${Lx} 0 ${Lx} units box
create_box         1 box
mass               1 1.7e-7

# create atom with id=1
create_atoms 1 single ${xcenter} ${xcenter} ${xcenter} units box
group        fst id == 1
velocity     fst set 0.0 0.0 0.0 units box

# create atom with id=2
variable          x2pos equal ${xcenter}+0.5*${h}
create_atoms 1 single ${x2pos} ${xcenter} ${xcenter} units box
group        scd id == 2
velocity     scd set 1.0 0.0 0.0 units box

create_atoms 1 single ${xcenter} ${x2pos} ${xcenter} units box
group        scd id == 3
velocity     scd set 1.0 0.0 0.0 units box


pair_style         hybrid/overlay sdpd/rhosum 1 sdpd

variable           rho0 equal 1.0
variable              c equal 0.1
variable           eta  equal 1.0
variable           temp equal 0.0
variable           gamma equal 1.0
variable           rho_background equal 0.0
variable           ktype string lucy
pair_coeff         * * sdpd     ${h} ${ktype} ${rho0} ${c} ${eta} ${temp} ${gamma} ${rho_background}
pair_coeff         * * sdpd/rhosum ${h} ${ktype}

# do full time integration
fix                integrate_fix_full all  meso

neighbor           0 bin
timestep           1e-19

variable           force_sdpd_fx equal fx[1]
variable           force_sdpd_fy equal fy[1]
compute            rho_peratom all meso_rho/atom
dump               dump_id all custom 1 dump*.dat id type x y vx vy c_rho_peratom
run                1

print              "f: ${force_sdpd_fx} ${force_sdpd_fy}"

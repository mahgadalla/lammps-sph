echo               both
log                ${dname}/log.lammps
dimension          ${ndim}
units              si
atom_style         meso
communicate        single vel yes
# create simulation box

#3D box
include            vars.lmp

# create fluid particles
# maxima -b ../../../../tools/maxima/example_gensphere.mac
read_data          test.data

include            model.lmp

compute            rho_peratom all meso_rho/atom
compute            ke all ke
compute            sdpd_kin all temp

fix                integrate_fix_full all meso/constrained

# "profile" corrected temperature
compute         pTemp all temp/profile 1 1 0 y 10
variable        nTemp equal c_pTemp*${kb}

dump               dump_id all custom ${Nfreq} ${dname}/dump*.dat id type x y z vx vy vz c_rho_peratom
dump_modify        dump_id first yes
dump_modify        dump_id sort id
dump_modify        dump_id pad 8

thermo_style       custom step c_sdpd_kin v_nTemp
thermo_modify      norm no
thermo             100

neighbor           0.0 bin
variable           eps delete
neigh_modify       every 1

include            sphere-potential.lmp


include            settimestep.lmp
timestep           ${dt}

restart 10000 ${dname}/sdpd.restart

write_data    ${dname}/in.data
run     100

variable           sdpd_temp equal 0
include            model.lmp

compute            cRDF  all rdf 50
fix                fRDF  all ave/time 100 1 100 c_cRDF file ${dname}/lrdf.dat mode vector ave running
run     200000

